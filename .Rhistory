library(csmpv)
library(csmpv)
packageVersion("csmpv")
########################
## 20240326, got 145 out 150 cases with survival data
#######################
library(rstudioapi)
current_working_dir = dirname(rstudioapi::getActiveDocumentContext()$path)
# "H:/AJiang2024/AJworking_2024/ShinyaRai_GerbenDuns/survival_145cases"
setwd(current_working_dir)
#######################################################################
# ### no need to read in 73 and work on 45 samples on 20240326, but I do need to keep the same cutoff as it was
# which was: 26.19768, when work on PMBL categorization, use PMBL > 26.19768 as high, otherwise low
## read in 150 cases, only 145 out of 145 have survival
dat = read.csv("Data_145outOf150cases.csv")
# > dim(dat)
# [1] 145  19
dat$RMBLgroup = ifelse(dat$mean_PMBL_score > 26.19768, "High", "Low")
# > table(dat$Rituximab)
#
# Yes
# 37 108
tdat = subset(dat, dat$Rituximab == "Yes")
# > dim(tdat)
# [1] 108  20
# > table(dat$RMBLgroup)
#
# High  Low
# 33  112
# > table(tdat$RMBLgroup)
#
# High  Low
# 29   79
write.csv(dat,"PMBLcut26.19768_145cases_20240326.csv")
write.csv(tdat,"PMBLcut26.19768_79casesRituximab_20240326.csv")
## KM plot
library(csmpv)
## 145 cases
confirmVars(data = dat, biomks = "RMBLgroup",
outcomeType = "time-to-event",
time = "Progression.free.survival..y.",
event = "CODE_PFS", outfile = "PMBLcut26.19768_145cases")
## 79 cases
confirmVars(data = tdat, biomks = "RMBLgroup",
outcomeType = "time-to-event",
time = "Progression.free.survival..y.",
event = "CODE_PFS", outfile = "PMBLcut26.19768_79casesRituximab")
